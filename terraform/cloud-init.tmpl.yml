#cloud-config
# Purpose: Initial bootstrap for a KVM/libvirt VM using Terraform
# - sets hostname dynamically
# - creates an admin user with SSH access
# - installs qemu-guest-agent and basic utilities
# - ensures SSH and guest agent start automatically

hostname: ${hostname}

package_update: true
package_upgrade: false  # change to true if you want to upgrade all packages at boot

users:
  - default
  - name: root
    gecos: "Nam"
    groups: [sudo, adm, wheel]
    sudo: ALL=(ALL) NOPASSWD:ALL
    shell: /bin/bash
    ssh_authorized_keys:
      - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOX3cZI7DumAq/NHh3HeB2daYZonCZlrgXpIYDHjMV41 namdp@vng.com.vn

packages:
  - qemu-guest-agent   
  - openssh-server     
  - python3            
  - htop               

runcmd:
  - systemctl enable --now ssh
  - systemctl enable --now qemu-guest-agent

final_message: "System setup complete. Hostname: ${hostname}"

